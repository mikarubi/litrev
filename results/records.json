[{"AB": " Interareal connectomes are whole-brain wiring diagrams of white-matter pathways. Recent studies have identified modules, hubs, module hierarchies and rich clubs as structural hallmarks of these wiring diagrams. An influential current theory postulates that connectome modules are adequately explained by evolutionary pressures for wiring economy, but that the other hallmarks are not explained by such pressures and are therefore less trivial. Here, we use constraint network models to test these postulates in current gold-standard vertebrate and invertebrate interareal-connectome reconstructions. We show that empirical wiring-cost constraints inadequately explain connectome module organization, and that simultaneous module and hub constraints induce the structural byproducts of hierarchies and rich clubs. These byproducts, known as spandrels in evolutionary biology, include the structural substrate of the default-mode network. Our results imply that currently standard connectome characterizations are based on circular analyses or double dipping, and we emphasize an integrative approach to future connectome analyses for avoiding such pitfalls.\n", "UT": "000389746000001", "TRU": "## RESULTS\n\n\n\n### Overview of the general approach\n\n The key steps in our approach are the choice of basic connectome hallmarks, the uniform sampling of networks constrained by these hallmarks, and the evaluation of sampled network accuracy. We now briefly describe each of these steps in turn.\n\n<span style=\"background-color: lightyellow\"> Our first step is the choice of basic connectome hallmarks. This choice is equivalent in spirit to the formulation of postulates or axioms essential for construction of systems of knowledge in any scientific field, including in biology[50]. Previous studies considered exponential-family or power-law relationships between physical<span style=\"background-color: pink\"> distance</span> and connection weight to be the candidate basic connectome hallmarks[8],[40],[51],[52]. Below we examined similar relationships in nonparametric wiring-cost models, but found that such relationships did not determine important aspects of connectome organization.</span>\n\n<span style=\"background-color: lightyellow\"> In contrast, we assumed that<span style=\"background-color: pink\"> modules</span> and<span style=\"background-color: pink\"> hubs</span>, the canonical forms of segregation and integration, represent such basic hallmarks of interareal connectomes. We denoted the anatomical composition of<span style=\"background-color: pink\"> modules</span> and<span style=\"background-color: pink\"> hubs</span> through intra<span style=\"background-color: pink\">-module</span> weight and node<span style=\"background-color: pink\">-strength</span> constraints (see \u2018Methods\u2019 section for mathematical definitions). We inferred these features from the data and thus ensured that our assumptions are empirically grounded. At the same time, and in contrast to more data-driven approaches[53], these assumptions are biological hypotheses, testable and falsifiable in future analyses, as we discuss below. In principle,<span style=\"background-color: pink\"> modules</span> and<span style=\"background-color: pink\"> hubs</span> may underpin the organization of other complex systems, but such assumptions need to be made on a domain-specific basis.</span>\n\n<span style=\"background-color: lightyellow\"> Our second step is the uniform sampling of networks with the specified empirical constraints. Uniform sampling is an important part of our approach, as it focuses the investigation on the basic hallmarks, and away from phenomenological generative mechanisms. However, it is hard to uniformly sample networks with all but the simplest constraints (it is unlikely that such sampling can be achieved in polynomial time). Here, we used two methods, with complementary<span style=\"background-color: pink\"> strengths</span> and weaknesses, to approximate such sampling with distinct strategies (see Table 1 and \u2018Methods\u2019 section for more details).</span>\n\n Table 1: Comparison of network sampling methods.\n\n [Full size table]\n\n Our primary method[54] is based on minimization of constraint errors with simulated annealing, a metaheuristic numerical optimization algorithm. This method samples networks with hard constraints, such that each network satisfies the constraints with high accuracy; we ensured that constraint errors were low (normalized constraint error <0.005) and similar for all sampled network models ([Supplementary Fig. 1]). We focused on results obtained with this method, due to its potential to uniformly sample networks with arbitrary constraints. However, it is important to note that despite this potential, such uniformity of sampling is not formally guaranteed.\n\n Our alternative sampling method[55] is based on maximum-likelihood estimation, an exact procedure for computing network probabilities. This method unbiasedly samples networks with soft constraints such that the constraints are satisfied on average in the full network ensemble, but not, in general, in each individually sampled network[56],[57]. However, it is important to note that sampling with soft constraints may not accurately approximate the target distributions we wish to sample, for instance if such distributions are multimodal.\n\n<span style=\"background-color: lightyellow\"> Our third step is the evaluation of accuracy with which the sampled networks reproduced the empirical<span style=\"background-color: pink\"> module</span> hierarchies and rich<span style=\"background-color: pink\"> clubs</span> ([Supplementary Table 1]). We evaluated the accuracy of<span style=\"background-color: pink\"> module</span> hierarchies with the normalized mutual information (NMI) between high- and low-resolution<span style=\"background-color: pink\"> module</span> and connectome partitions. This measure of partition similarity ranges from 1 for identical partitions to 0 for maximally different partitions, or in the absence of stable partitions. We accounted for inaccuracies due to variability of individual samples by comparing our results with a hierarchical benchmark model, a model with constrained high- and low-resolution intra- and inter<span style=\"background-color: pink\">-module</span> weight, as well as node<span style=\"background-color: pink\"> strength</span> ([Supplementary Fig. 2c]). In practice, this benchmark provided an upper bound on the accuracy of hierarchical structure in our studied models.</span>\n\n<span style=\"background-color: lightyellow\"> We evaluated the existence of empirical rich<span style=\"background-color: pink\"> clubs</span> by computing the model/connectome empirical rich<span style=\"background-color: pink\">-club</span> density for each model. A model lacks a rich<span style=\"background-color: pink\"> club</span> when this density is much lower than one, and possesses a rich<span style=\"background-color: pink\"> club</span> otherwise. The rich<span style=\"background-color: pink\">-club</span> density, unlike the NMI, is a physical quantity, such that variability of individual samples averages out in the network ensemble; in practice this makes comparison with a benchmark model less necessary.</span>\n\n We reported all results as medians (interquartile ranges) estimated from 100 network samples for each type of model.\n\n<span style=\"background-color: lightyellow\"> Figure 3: Wiring-cost constraints systematically underestimate intra<span style=\"background-color: pink\">-module</span> weight in mouse and fly interareal connectome reconstructions.</span>\n\n [[Figure 3]]\n\n<span style=\"background-color: lightyellow\"> Left and middle: scatter plots of connectome versus model high-resolution intra<span style=\"background-color: pink\">-module</span> weight and node<span style=\"background-color: pink\"> strength</span> for models with (a) minimized wiring-cost model, (b) constrained wiring-cost, (c) constrained wiring-cost and node<span style=\"background-color: pink\"> strength</span> and (d) constrained basic hallmarks, as described in the main text. Network models constrained by empirical levels of wiring-cost (b,c) had lower intra<span style=\"background-color: pink\">-module</span> weight for all<span style=\"background-color: pink\"> modules</span> in both connectome reconstructions. All networks were sampled with the primary (hard-constraint) method. Bars show medians and interquartile ranges estimated from 100-sampled network models. All values for the fly connectome were divided by 1,000 for clarity of presentation. Right:<span style=\"background-color: pink\"> graph</span> visualizations of connections averaged over 100-network model samples, presented and coloured as in [Fig. 1].</span>\n\n [Full size image]\n\n### Wiring cost and module organization\n\n<span style=\"background-color: lightyellow\"> Current notions consider low wiring cost to represent an accurate proxy of<span style=\"background-color: pink\"> module</span> organization. Indeed, minimized wiring-cost spatial lattices, network models constructed by assigning progressively stronger weights to shorter pathways, had a relatively high NMI with high-resolution connectome<span style=\"background-color: pink\"> module</span> partitions (NMI: mouse 0.68 (0.68\u20130.69), fly: 0.62 (0.60\u20130.62); Fig. 4a,b). Nonetheless the<span style=\"background-color: pink\"> module</span> organization of these lattices was less accurate than that of the benchmark models (NMI mouse 0.84 (0.81, 0.87), fly: 0.84 (0.79, 0.86); [Supplementary Fig. 3a,b]). Qualitatively, the accuracy was highest for the more peripheral and well-delineated<span style=\"background-color: pink\"> modules</span>, such as the brainstem and cerebellar<span style=\"background-color: pink\"> modules</span> of the mouse, and the visual<span style=\"background-color: pink\"> module</span> (optic lobe) of the fly, and lowest for the more central and spatially intertwined<span style=\"background-color: pink\"> modules</span>, such as the olfactory and hippocampal<span style=\"background-color: pink\"> modules</span> of the mouse, and the premotor<span style=\"background-color: pink\"> module</span> (central complex) of the fly.</span>\n\n<span style=\"background-color: lightyellow\"> Figure 4:<span style=\"background-color: pink\"> Module</span> hierarchies and rich<span style=\"background-color: pink\"> clubs</span> are structural byproducts of basic connectome hallmarks.</span>\n\n<span style=\"background-color: lightyellow\"> [[Figure 4]] (a,b) NMI between model and connectome hierarchical<span style=\"background-color: pink\"> module</span> partitions. Horizontal lines indicate corresponding medians of benchmark models (cf. [Supplementary Fig. 3a,b]). (c,d) Normalized (model/connectome) rich<span style=\"background-color: pink\">-club</span> densities. Horizontal lines indicate the rich<span style=\"background-color: pink\">-club</span> density threshold of 1. The minimized-wiring-cost model approximated high-resolution<span style=\"background-color: pink\"> module</span> structure, but did not reproduce hierarchical or rich<span style=\"background-color: pink\">-club</span> structure. The two wiring-cost-constrained models did not reproduce hierarchical or rich<span style=\"background-color: pink\">-club</span> structure. In contrast, the basic-hallmark model reproduced hierarchical and rich<span style=\"background-color: pink\">-club</span> structures in both connectome reconstructions. All networks were sampled with the primary (hard-constraint) method. Bars show the medians and interquartile ranges estimated from 100-network model samples.</span>\n\n [Full size image]\n\n<span style=\"background-color: lightyellow\"> Spatial lattices are artificial models with unrealistically low wiring cost, and it is generally assumed that modifications of these lattices which increase wiring cost to realistic levels (for example, through inclusion of long and costly inter<span style=\"background-color: pink\">-module</span> connections), have little effect on<span style=\"background-color: pink\"> module</span> organization. However, this assumption is typically tested with phenomenological models. Here, we found that this assumption is inaccurate; network models with empirical levels of wiring cost had consistently low intra<span style=\"background-color: pink\">-module</span> weight (Fig. 3b,c), and a low NMI with high-resolution<span style=\"background-color: pink\"> module</span> partitions in both connectomes (NMI mouse: 0.43 (0\u20130.50), fly: 0.48 (0.39\u20130.53); Fig. 4a,b). These results suggest that realistic wiring-cost constraints, with no additional assumptions, represented an insufficient determinant of<span style=\"background-color: pink\"> module</span> organization.</span>\n\n### Basic hallmarks and structural byproducts\n\n<span style=\"background-color: lightyellow\"> In contrast, we adopted the intra<span style=\"background-color: pink\">-module</span> weight of high-resolution<span style=\"background-color: pink\"> modules</span> as a more direct constraint of<span style=\"background-color: pink\"> module</span> organization. We introduced the basic-hallmark model, a network model with constrained intra<span style=\"background-color: pink\">-module</span> weight and node<span style=\"background-color: pink\"> strength</span> (Fig. 3d and \u2018Methods\u2019 section). The basic-hallmark model, unlike wiring-cost constrained models, reproduced the high-resolution<span style=\"background-color: pink\"> module</span> organization of both connectomes (NMI mouse: 0.85 (0.84\u20130.87), fly: 0.84 (0.79\u20130.88); Fig. 4a,b) with accuracy comparable to the benchmark model (above), and thus allowed us to study more directly the effects of combined<span style=\"background-color: pink\"> module</span> and<span style=\"background-color: pink\"> hub</span> constraints on other connectome features.</span>\n\n<span style=\"background-color: lightyellow\"> The basic-hallmark model reproduced much of the (not explicitly constrained) low-resolution<span style=\"background-color: pink\"> module</span> organization of both connectomes (NMI mouse: 0.71 (0.68\u20130.75), fly: 0.71 (0.64\u20130.76); Fig. 4a,b) with accuracy comparable to, or lower than, the benchmark model (NMI mouse: 0.75 (0.71, 0.81), fly 0.89 (0.83, 0.92); [Supplementary Fig. 3a,b]). These results suggest that<span style=\"background-color: pink\"> module</span> and<span style=\"background-color: pink\"> hub</span> constraints induced<span style=\"background-color: pink\"> module</span> hierarchies, likely through a better approximation of inter<span style=\"background-color: pink\">-module</span> weights ([Supplementary Fig. 2d]). This effect is nontrivial, and low-resolution<span style=\"background-color: pink\"> modules</span> were less well reproduced with other models, such as models with constrained wiring cost and node<span style=\"background-color: pink\"> strength</span> (NMI mouse: 0.22 (0\u20130.35), fly: 0.18 (0.17\u20130.30); Fig. 4a,b), and a model with constrained intra<span style=\"background-color: pink\">-module</span> weight but not node<span style=\"background-color: pink\"> strength</span> (NMI mouse: 0.30 (0.30\u20130.46), fly: 0.50 (0.46\u20130.56); [Supplementary Fig. 3a,b]). In general, we noted smaller effect sizes for the fly connectome, consistent with its less well-resolved connectome reconstruction (44% of nodes and 30% of connections of the mouse connectome reconstruction); we posit that such effect sizes will increase in more highly resolved reconstructions.</span>\n\n<span style=\"background-color: lightyellow\"> The basic-hallmark model additionally, and in contrast to simpler models, reproduced all rich<span style=\"background-color: pink\">-club</span> densities in both connectomes (Fig. 4c,d and [Supplementary Fig. 3c,d]), namely the visual-auditory rich<span style=\"background-color: pink\"> club</span> (model/connectome rich<span style=\"background-color: pink\">-club</span> density: 0.95 (0.92\u20130.97)) and the default-mode rich<span style=\"background-color: pink\"> club</span> (density: 1.04 (0.96\u20131.12)) of the mouse connectome, as well as the inner-shell rich<span style=\"background-color: pink\"> club</span> (density: 0.97 (0.92\u20131.03)), and the outer-shell rich<span style=\"background-color: pink\"> club</span> (density: 1.01 (0.99\u20131.04)) of the fly connectome. The visual-auditory and the inner-shell rich<span style=\"background-color: pink\"> clubs</span> are largely localized within<span style=\"background-color: pink\"> modules</span> (Fig. 1b, [Supplementary Table 1]), and so it is unsurprising that constrained intra<span style=\"background-color: pink\">-module</span> weights enforced these rich<span style=\"background-color: pink\">-club</span> densities to empirical levels. In contrast, the default-mode and the outer-shell rich<span style=\"background-color: pink\"> clubs</span> are not localized to specific<span style=\"background-color: pink\"> modules</span> and are therefore not subject to the same mechanism. Most interestingly, the default-mode rich<span style=\"background-color: pink\"> club</span> is comprised of nodes which, by virtue of their highly distributed connections, could not be assigned to any<span style=\"background-color: pink\"> modules</span> and could not therefore be directly affected by constrained intra<span style=\"background-color: pink\">-module</span> weight (Fig. 1b, [Supplementary Table 1a]). The accurate reproduction of this rich<span style=\"background-color: pink\">-club</span> density is likely to arise from indirect effects of combined<span style=\"background-color: pink\"> module</span> and<span style=\"background-color: pink\"> hub</span> constraints. The many strong connections of<span style=\"background-color: pink\"> hub</span> nodes cannot be equally distributed between<span style=\"background-color: pink\"> modules</span> (to maintain constrained intra<span style=\"background-color: pink\">-module</span> weights) and must therefore be preferentially placed between other<span style=\"background-color: pink\"> hubs</span>, enforcing the connectivity within this rich<span style=\"background-color: pink\"> club</span> to empirical levels.</span>\n\n### Robustness of results to differences in sampling\n\n<span style=\"background-color: lightyellow\"> We evaluated the robustness of our results to differences in sampling, using an alternative sampling method. This alternative method supports weighted node and<span style=\"background-color: pink\"> module</span> constraints, but not wiring-cost constraints, nor simultaneous binary and weighted constraints; in addition, the method does not preserve empirical connection weights (Table 1). This method guarantees that imposed constraints are satisfied on average in the full network ensemble: [Supplementary Fig. 4a\u2013h] shows decreases in constraint error associated with increases in sampled network ensemble size. We noted that 1,000-network ensembles had similar constraint errors to our primary sampling method (cf. [Supplementary Fig. 1]), and for ease of comparison, focused on averages of network measures (that is, on consensus<span style=\"background-color: pink\"> module</span> partitions and average rich<span style=\"background-color: pink\">-club</span> densities) computed on these 1,000-network ensembles (for completeness, Fig. 5 also shows results computed on single networks). Note that averages of measures computed over 1,000-network ensembles were very stable, and thus mostly had negligible variance.</span>\n\n Figure 5: Results for the basic-hallmark model are robust to sampling methods.\n\n [[Figure 5]]\n\n<span style=\"background-color: lightyellow\"> Basic-hallmark model sampled with the primary (hard-constraint) and alternative (soft-constraint) methods (a,b) NMI between model and connectome hierarchical<span style=\"background-color: pink\"> module</span> partitions. Horizontal lines indicate medians of benchmark models (see also [Supplementary Fig. 3a,b]). (c,d) Normalized (model/connectome) rich<span style=\"background-color: pink\">-club</span> densities. Horizontal lines indicate the rich<span style=\"background-color: pink\">-club</span> density threshold of one. Averages of network measures from 1,000-network ensembles sampled with the alternative method (model ii) reproduced the hierarchical and rich<span style=\"background-color: pink\">-club</span> structures in both connectome reconstructions. Moreover, rich<span style=\"background-color: pink\">-club</span> densities of networks sampled with this method were even higher than rich<span style=\"background-color: pink\">-club</span> densities of the connectomes. Bars show the medians and interquartile ranges estimated from 100-network model samples (for the primary method) or 100-network model ensembles (for the alternative method).</span>\n\n [Full size image]\n\n<span style=\"background-color: lightyellow\"> Results for the basic-hallmark model were robust to differences in sampling methods. Figure 5a,b shows that the basic-hallmark model sampled with the alternative method, similarly reproduced the high-resolution (NMI mouse: 0.88 (0.88\u20130.88), fly: 0.79 (0.79\u20130.79)) and low-resolution (NMI mouse: 0.75 (0.75\u20130.79), fly: 0.66 (0.66\u20130.66)) connectome<span style=\"background-color: pink\"> module</span> partitions. Furthermore, a simpler model with constrained intra<span style=\"background-color: pink\">-module</span> weight but not node<span style=\"background-color: pink\"> strength</span> reproduced the low-resolution partition less accurately in the mouse (NMI: 0.30 (0.30\u20130. 30), [Supplementary Fig. 6a]) but more accurately in the fly (NMI: 0.88 (0.88\u20130.88), [Supplementary Fig. 6b]); future analyses of more highly resolved connectome reconstructions should help to resolve this discrepancy.</span>\n\n<span style=\"background-color: lightyellow\"> Figure 5c,d shows that the basic-hallmark model sampled with the alternative method reproduced all rich<span style=\"background-color: pink\">-club</span> densities in both connectomes. Moreover, rich<span style=\"background-color: pink\">-club</span> densities in these models were even higher than in the connectomes; especially for the mouse default-mode rich<span style=\"background-color: pink\"> club</span> (density: 1.45 (1.45\u20131.46)), and for the fly inner-shell rich<span style=\"background-color: pink\"> club</span> (density: 1.25 (1.24\u20131.26)). We investigated this effect in more detail by considering a third sampling method, which had properties intermediate to the primary and alternative methods. On the one hand, this method sampled networks with hard constraints and thus automatically preserved connection weights (similar to the primary method); on the other hand, this method matched only weighted, but not binary, constraints (similar to the alternative method). Basic-hallmark models sampled with this method had rich<span style=\"background-color: pink\">-club</span> densities closer to empirical levels (default-mode rich<span style=\"background-color: pink\"> club</span>: 1.24 (1.16\u20131.32), inner-shell rich<span style=\"background-color: pink\"> club</span>: 1.00 (0.95\u20131.04)), suggesting that the absence of additional binary and connection-weight constraints surprisingly raised these densities to higher-than-empirical levels.</span>\n\n\n\n## METHODS\n\n\n\n### Mouse interareal connectome data set\n\n<span style=\"background-color: lightyellow\"> We studied the mouse interareal connectome reconstruction described in Rubinov et al.[8] and based on data from 461 anterograde recombinant adeno-associated virus tracer injections in adult male wild-type C57BL/6J mice, registered into a common template brain and made available by the Allen Institute for Brain Science at [h<span>tt</span>p://connectivity.brain-map.org/] (ref. [4]). The whole brain was subdivided into 56 bilaterally symmetric areas (a total of 112 areas), using a developmental ontology for extra-cortical areas from [h<span>tt</span>p://developingmouse.brain-map.org/] (refs [68], [69]) and a topographic ontology for cortical areas from [h<span>tt</span>p://mouse.brain-map.org/] (ref. [70]). See [Supplementary Table 1a] for all region names and Puelles et al.[68] for comparison of topographic and developmental ontologies. Directed interareal projection weights were quantified as projection densities normalized by areal volumes; 6,542 connections were detected (53% connection density) and connection weights scaled over several orders of magnitude ([Supplementary Fig. 4i]). Interareal<span style=\"background-color: pink\"> distances</span> of white-matter pathways were quantified with deterministic tracer tractography, and tract bandwidth, a measure of pathway capacity, was quantified as the normalized estimated pathway cross-section[8]. All injections were right sided, and whole-brain connectome reconstruction assumed hemispheric symmetry.</span>\n\n### Drosophila interareal connectome data set\n\n<span style=\"background-color: lightyellow\"> We studied the Drosophila interareal connectome reconstruction described in Shih et al.[10], and based on data for 12,995 GFP-labelled projection neurons in adult female Drosophila, registered into a common template brain and made available as part of the FlyCircuit database at [h<span>tt</span>p://w<span>ww</span>.flycircuit.tw/] (ref. [9]). The whole brain was subdivided into 23 bilaterally symmetric areas and 3 unpaired areas of the central complex (a total of 49 areas), using detection of local processing units, anatomically contiguous areas with self-contained local-neuron populations[9]. See [Supplementary Table 1b] for all region names and Ito et al.[71] for comparisons with other anatomical nomenclatures. Directed interareal connection weights were quantified as the mean number of dendritic and axonal terminals for each neuron summed over all neurons for each area; 1,950 connections were detected (83% connection density), and connection weights scaled over several orders of magnitude ([Supplementary Fig. 4j]). For the present study, we additionally quantified interareal<span style=\"background-color: pink\"> distances</span> of white-matter pathways with deterministic tracer tractography along masks of white-matter pathways from the FlyCircuit database, which we affinely registered to the JFRC2 adult Drosophila brain template[72] made available by the Virtual Fly Brain resource at [h<span>tt</span>p://w<span>ww</span>.virtualflybrain.org/] (ref. [73]). In the absence of pathway cross-section information, we equated tract bandwidth with pathway connection weight.</span>\n\n### Constraint network models\n\n<span style=\"background-color: lightyellow\"> We represent each network by its directed weights matrix W={wij} and denote the special case of the connectome itself by <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m1_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">. We seek to generate ensembles of random networks which satisfy k types of constrains imposed by node,<span style=\"background-color: pink\"> module</span>, wiring-cost or other network features. We represent each network feature by <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m2_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">, where i is the index on the type on constraint (for example, node<span style=\"background-color: pink\"> strength</span>) and j is the index of each constrained element (for example, the<span style=\"background-color: pink\"> strength</span> of node j). We denote the special case of connectome features we seek to constrain by <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m3_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">.</span>\n\n<span style=\"background-color: lightyellow\"> The node<span style=\"background-color: pink\"> strength</span> is defined as</span>\n\n <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m4_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n where the sum is over all nodes in the network.\n\n The node wiring cost is defined as\n\n <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m5_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n where dij is the length and bij is the bandwidth, of directed white-matter pathway from i to j.\n\n<span style=\"background-color: lightyellow\"> The total weight between<span style=\"background-color: pink\"> modules</span> u and v is defined as</span>\n\n <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m6_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n<span style=\"background-color: lightyellow\"> where the sums are over nodes in both<span style=\"background-color: pink\"> modules</span>; luu is the intra<span style=\"background-color: pink\">-module</span> weight of u.</span>\n\n<span style=\"background-color: lightyellow\"> We constrained node<span style=\"background-color: pink\"> strengths</span> and wiring costs for all nodes, and we constrained intra- and inter<span style=\"background-color: pink\">-module</span> weights for all<span style=\"background-color: pink\"> modules</span>, whenever these constraints were imposed. In addition, our primary sampling method preserved weighted and binary variants of all constraints, while our alternative sampling method preserved only weighted variants of all constraints (Table 1). We computed binary variants of all constraints by substituting all weights wij (and independently all bandwidths bij) with adjacencies aij representing the presence (aij=1) or absence (aij=0) of a connection from node i to node j.</span>\n\n### Primary network sampling method\n\n This sampling method is based on constrained randomization of empirical networks and aims to uniformly sample networks with hard constraints, such that each individual sampled network in the ensemble satisfies the constraints exactly[54]. Each network in the ensemble is sampled by randomizing the connectome, while numerically minimizing the constraint error E, <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m7_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n<span style=\"background-color: lightyellow\"> where <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m8_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\"> is the arithmetic mean over all constraints of type i (for example, node<span style=\"background-color: pink\"> strength</span>), and q defines the type of error. E is essentially a generalized mean, <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m9_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">, of the mean absolute constraint error, <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m10_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">, normalized by individual constraint magnitude, <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m11_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">. In this study, we used q=2, and thus minimized the mean squared error; the choice of q does not affect the global minimum of E, and exploratory analyses using the mean absolute error (q=1), or the maximum absolute error (q\u2192\u221e), did not our change results. We also note that the connectome satisfies E=0 for all combinations of q and constraints <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m12_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">; this underscores the empirical grounding of constraint network models.</span>\n\n We minimized the constraint error using simulated annealing, a popular metaheuristic search algorithm motivated by the analogy of cooling a physical system. Global minimization with simulated annealing is implemented by iteratively swapping random pairs of connections with probability 1 if such swaps lower the error (\u0394E<0), or with probability exp(\u2212\u0394E/T) otherwise. At the start of each search, the parameter T (\u2018temperature\u2019 in the physical analogy) is very high, such that effectively all swaps are accepted, and the system is randomized without constraints. As the search proceeds, T is slowly reduced (\u2018the system is cooled\u2019 in the physical analogy), such that swaps which raise the error are less likely to become accepted. Towards the end of the search, T is very low, such that effectively only swaps which reduce the error are accepted.\n\n The simulated annealing search satisfies the conditions of ergodicity (that is, it can reach all possible network states), and reversibility (that is, all swaps are potentially reversible), and consequently, with a sufficiently slow lowering of T (\u2018cooling schedule\u2019 in the physical analogy), it is guaranteed to escape local minima, and to reach all global minima with equal probability\u2014in other words to uniformly sample all networks exactly matching the specified constraints[74]. However, in practice it is not possible to say precisely what constitutes a sufficiently slow cooling schedule for each system; moreover, it is likely that sufficiently slow cooling schedules are computationally impractical. Here we set a more realistic goal of sampling networks with a small error, E<0.005, comparable to 0.5% deviation from the global minimum E=0 ([Supplementary Fig. 1]).\n\n Our search starts by shuffling the empirical connectome, with preserved bilateral weight relationships or symmetry. We preserved bilateral weight relationships, since the bilateral symmetry assumption was inherent in the weight reconstruction of the mouse connectome (above), and since approximate bilateral symmetry was also observed in the Drosophila connectome (Spearman correlation of 0.82 between bilaterally symmetric connections).\n\n We used a slow cooling schedule, initially setting T=1, which in practice allows network randomization without constraints. At every iteration, we randomly swapped two connection weights, and their bilaterally symmetric equivalents, and accepted this swap with\n\n <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m13_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n We ran the algorithm for 109 iterations, and slowly reduced the temperature, as Tnew\u21900.999T, at every 104 iterations.\n\n### Alternative network sampling method\n\n<span style=\"background-color: lightyellow\"> This sampling method is based on exact maximum-likelihood estimation of maximum-entropy/exponential random<span style=\"background-color: pink\">-graph</span> models, and aims to unbiasedly sample networks with soft constraints, such that the constraints are exactly satisfied for the full network ensemble average, but not for each individual network[55]. For each connectome matrix <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m14_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\"> and set of constraints <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m15_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">, we sample constraint models W from a probability P(W). It can be shown[75] that the only unbiased choice of probability P(W) in this case is the one which maximizes the entropy S, <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m16_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\"></span>\n\n subject to the constraints\n\n <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m17_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n where c(W) is the value of c computed in network W, and <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m18_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\"> is the average of all c(W) in the network ensemble.\n\n It is possible to derive the expression for the unbiased probability P(W), by introducing for each constraint <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m19_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\"> auxiliary variables, known as Lagrange multipliers, <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m20_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">, using these variables to write the entropy with constraints as a single expression, differentiating this expression with respect to P(W), and setting the derivative to 0. This gives\n\n <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m21_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n<span style=\"background-color: lightyellow\"> where the function <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m22_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">, also known as the<span style=\"background-color: pink\"> graph</span> Hamiltonian, enforces the constraints</span>\n\n <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m23_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n and the normalization constant Z(\u03b8), also known as the partition function, is given by\n\n <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m24_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n<span style=\"background-color: lightyellow\"> A binary version of these models has been extensively studied under the name of p\\* or exponential random<span style=\"background-color: pink\">-graph</span> models[56],[57]. Here, we make use of recent results which show that for first-order constraints (which include node<span style=\"background-color: pink\">-strength</span> and<span style=\"background-color: pink\"> module-weight</span>, but not wiring-cost constraints), it is possible to derive exact expressions for the maximum-likelihood values of \u03b8, solve these expressions numerically and thus estimate the maximum likelihood of P(W) (ref. [55]). We summarize these results below and refer the reader to a detailed exposition of these results in ref. [55].</span>\n\n<span style=\"background-color: lightyellow\"> In the most general case of node<span style=\"background-color: pink\">-strength</span> and<span style=\"background-color: pink\"> module-weight</span> constraints, with u and v denoting the<span style=\"background-color: pink\"> modules</span> of node i and j respectively, H(W, \u03b8) may be factorized as:</span>\n\n <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m25_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n and the normalization constant Z(\u03b8) may be written exactly as\n\n <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m26_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n where we assumed integer weights without loss of generality (real-valued weights can be linearly mapped to integers with arbitrary precision). Furthermore, the probability P(W|\u03b8) may be factorized as:\n\n <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m27_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n where <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m28_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">, the conditional probability of each connection weight, is expressed as:\n\n <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m29_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n with\n\n <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m30_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n such that each individual (non-negative) integer weight wij is essentially sampled from the so-called geometric distribution <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m31_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\"> (ref. [76]).\n\n After introducing auxiliary variables, <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m32_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">, <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m33_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">, and <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m34_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">, the expectation of each geometrically distributed weight <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m35_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\"> can be written analytically as:\n\n <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m36_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n The constraints can now be directly expressed in terms of weight expectations, <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m37_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\"><img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m38_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\"><img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m39_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n This coupled system of nonlinear equations is easily solved with modern numerical software (we used MATLAB\u2019s fsolve). This solution is equivalent to the maximum-likelihood estimate for \u03b8, and thus finally gives us the unbiased probabilities of individual connection weights Pij(wij).\n\n### Cost-minimized lattice model\n\n<span style=\"background-color: lightyellow\"> We compared constraint models with the widely studied wiring-cost-minimized generative model, constructed by assigning progressively stronger weights to shorter pathways. To robustly assign weights to connections with similar lengths, we perturbed the estimated<span style=\"background-color: pink\"> distance</span> of each pathway by uniform noise on the order of 1% median connection<span style=\"background-color: pink\"> distance</span>; in practice this had negligible effect on the final results.</span>\n\n### Assessment of module hierarchies\n\n<span style=\"background-color: lightyellow\"> Similarly to the original analyses of these connectome reconstructions, we detected<span style=\"background-color: pink\"> module</span> hierarchies using a multistep metaheuristic optimization algorithm based on maximization of the<span style=\"background-color: pink\"> modularity</span> statistic[77], <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m40_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\"></span>\n\n<span style=\"background-color: lightyellow\"> where \u03b3 is a<span style=\"background-color: pink\"> module-resolution</span> parameter (such that higher \u03b3 results in smaller<span style=\"background-color: pink\"> modules</span>) and v is a normalization constant (equivalent to the total network weight).</span>\n\n<span style=\"background-color: lightyellow\"> We detected characteristic<span style=\"background-color: pink\"> module</span> partitions for each \u03b3=0.5, 0.55,\u2026, 2.5 by performing consensus<span style=\"background-color: pink\"> clustering</span>[78] on 1,000 local-maxima partitions[79] obtained at each value of \u03b3 (ref. [80]). We defined partitions as stable if they did not change for an interval of length \u22650.2 (for example, for an interval of 1.0\u2264\u03b3\u22641.2). These criteria ensured that the detected<span style=\"background-color: pink\"> modules</span> were robust to a range of<span style=\"background-color: pink\"> module-resolution</span> parameter values. In the mouse connectome we detected a two-level hierarchical organization, equivalent to our original analysis of these data (Fig. 1b, [Supplementary Table 1a])[8]. In the fly connectome we also detected a two-level hierarchical organization as in the original analysis of these data (Fig. 1b, [Supplementary Table 1b])[10]; however, in contrast to the original analysis, which simply assumed the presence of a stable low-resolution partition at \u03b3=1, we detected a low-resolution partition at a slightly higher 1.15\u2264\u03b3\u22641.3. For consistency with the original analysis, we fixed \u03b3=1 for the low-resolution partition of the fly connectome and network models, noting that the precise choice of \u03b3 for this partition did not change our results.</span>\n\n<span style=\"background-color: lightyellow\"> We compared the accuracy of<span style=\"background-color: pink\"> module</span> hierarchies in each network model, by applying the<span style=\"background-color: pink\"> module</span> detection algorithm to each model, and quantifying the similarity of stable partitions, closest in \u03b3 to the low-resolution and high-resolution partitions of each connectome. We quantified partition similarity with the NMI, a widely used information-theoretic measure of partition similarity defined as:</span>\n\n <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m41_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">\n\n where <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m42_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\"> and M are connectome and model partitions, S(M) is the entropy and <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m43_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\"> is the joint entropy. NMI is 1 for identical partitions, and 0 for maximally different partitions, or in the absence of stable partitions.\n\n### Assessment of rich clubs\n\n<span style=\"background-color: lightyellow\"> Rich<span style=\"background-color: pink\"> clubs</span> or<span style=\"background-color: pink\"> cores</span> are surprisingly highly connected groups of<span style=\"background-color: pink\"> hub</span> nodes[81]. Analyses demonstrated the presence of two rich<span style=\"background-color: pink\"> clubs</span> in each of the mouse and fly connectomes (Fig. 1, [Supplementary Table 1])[8],[10]. We assessed the existence of rich<span style=\"background-color: pink\"> clubs</span> in network models by computing, for each rich<span style=\"background-color: pink\"> club</span> R, the normalized rich<span style=\"background-color: pink\">-club</span> density[82], <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m44_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\"></span>\n\n<span style=\"background-color: lightyellow\"> where wij and <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m45_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\"> denote connection weights of the model and connectome respectively, and the sums are over all nodes in the rich<span style=\"background-color: pink\"> club</span>. This measure is equivalent to the inverse rich<span style=\"background-color: pink\">-club</span> coefficient[81]. A network lacks a rich<span style=\"background-color: pink\"> club</span> when D(R)<1, and has a rich<span style=\"background-color: pink\"> club</span> when <img src=\".\\results\\eqns\\ref000389746000001_http_media_nature_com_full_nature_assets_ncomms_2016_161207_ncomms13812_images_ncomms13812_m46_gif\" alt=\"Equation\" style=\"display:inline-block; vertical-align:bottom\">.</span>\n\n### Code availability\n\n Relevant code is available on request from the author, from the author's website ([h<span>tt</span>p://w<span>ww</span>.mikail-rubinov.net/]), or from the Brain Connectivity Toolbox ([h<span>tt</span>p://w<span>ww</span>.brain-connectivity-toolbox.net/]).\n\n### Data availability\n\n Mouse connectivity data was obtained and made available by the Allen Institute for Brain Science, USA ([h<span>tt</span>p://w<span>ww</span>.brain-map.org/]). Drosophila connectivity data was obtained and made available by the National Center for High-performance Computing and National Tsing Hua University, Taiwan ([h<span>tt</span>p://w<span>ww</span>.flycircuit.tw/]). Relevant data are available on request from the author.\n\n", "Q1": "yes", "Q2": "yes", "Q3": "no", "Q4": "no"}, {"AB": " \n", "UT": "000000000000", "TRU": " \n", "Q1": "not answered", "Q2": "not answered", "Q3": "not answered", "Q4": "not answered"}]